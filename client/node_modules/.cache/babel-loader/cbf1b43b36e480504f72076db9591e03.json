{"ast":null,"code":"import _objectSpread from \"/Users/andrewhigton/Documents/mern/SatCinemaClub/client/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/andrewhigton/Documents/mern/SatCinemaClub/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/andrewhigton/Documents/mern/SatCinemaClub/client/src/components/booking-page/BookingPage.js\";\n// todo \n//at the moent - trying to get the screen to update with new model\n// 1 enter number of tickets, calculate price,  go to booking payment DONE\n// 2 send new object to createFilm - now can't update, creates new film. \n//if you update profile, you overwrite the current film\n//if you update with fn removed, you create new version of same film\n// what's the answer.\n// separate the creation and update functions DONE\n//need to separete the films and users, akin to exp in devconnectors, and update separately \n//but first, can you update via overwriting the _id first before major reconconstruction?\n// 3 create tickets, return to dashboard with tickets on dashboard\n// 4 with two sections, one for films, one for tickets \n// 5 why is bookpage called twice?\n// 6 why can i not navigate between the pages without losing the data?\n// morning\n// check video for ways out \n// try to get the _id working\n// at what point are you putting the films in to their own db? \n//ok, trying to get the id again, sure i can do it.\n//you know, just check back in to master.\n//can't load films now, something gone wrong with the db\nimport React, { useEffect, useState, Fragment } from 'react';\nimport { useParams } from 'react-router';\nimport { Link, withRouter, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { updateFilm, getCurrentProfile } from '../../actions/profile';\nimport StripeCheckoutButton from '../../components/stripe-button/stripe-button';\nimport queryString from 'query-string';\n\nconst CheckoutPage = ({\n  updateFilm,\n  getCurrentProfile,\n  // profile: { profile, loading },\n  history // id,\n\n}) => {\n  const _useState = useState({\n    _id: '',\n    user: '',\n    title: '',\n    date: '',\n    cinema: '',\n    image: '',\n    ticketPrice: '',\n    crowdfundTarget: '',\n    totalsoFar: ''\n  }, [setFormData]),\n        _useState2 = _slicedToArray(_useState, 2),\n        formData = _useState2[0],\n        setFormData = _useState2[1];\n\n  let params = useParams();\n  const film = params;\n\n  const _useState3 = useState(0),\n        _useState4 = _slicedToArray(_useState3, 2),\n        bookingTotal = _useState4[0],\n        setBookingTotal = _useState4[1]; // fills the values with current values\n\n\n  useEffect(() => {\n    getCurrentProfile();\n    setFormData({\n      _id: !film._id ? '' : film._id,\n      user: !film.user ? '' : film.user,\n      title: !film.title ? '' : film.title,\n      cinema: !film.cinema ? '' : film.cinema,\n      date: !film.date ? '' : film.date,\n      image: !film.image ? '' : film.image,\n      ticketPrice: !film.ticketPrice ? '' : film.ticketPrice,\n      crowdfundTarget: !film.crowdfundTarget ? '' : film.crowdfundTarget,\n      totalsoFar: !film.totalsoFar ? '' : film.totalsoFar\n    });\n  }, [loading, getCurrentProfile]);\n  let _id = formData._id,\n      user = formData.user,\n      title = formData.title,\n      date = formData.date,\n      cinema = formData.cinema,\n      image = formData.image,\n      ticketPrice = formData.ticketPrice,\n      crowdfundTarget = formData.crowdfundTarget,\n      totalsoFar = formData.totalsoFar;\n  let tickets = 0;\n\n  const onChange = e => {\n    // setFormData({ ...formData, [e.target.name]: e.target.value });\n    tickets = profile.totalsoFar + parseInt(e.target.value);\n    setBookingTotal(parseInt(profile.ticketPrice) * parseInt(e.target.value));\n    setFormData(_objectSpread({}, formData, {\n      totalsoFar: tickets\n    })); // console.log(bookingTotal)\n  };\n\n  const onSubmit = (e, film_id) => {\n    e.preventDefault();\n    console.log(film_id);\n    updateFilm(formData, history);\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"checkout-page how-it-works\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"checkout-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  }, \"Film: \", profile.title)), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, \"Date: \", profile.date, \" \")), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, \"Price: \\xA3\", profile.ticketPrice, \" \")), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, \"Crowdfunding Target: \", profile.crowdfundTarget, \" \")), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, \"Tickets sold: \", profile.totalsoFar)), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, profile._id))))), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    type: \"number\",\n    placeholder: \"Enter number of tickets\",\n    name: \"tickets\",\n    onChange: e => onChange(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"header-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, \"Basket total: \\xA3\", bookingTotal)), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  }, React.createElement(Link, {\n    className: \"btn btn-light my-1\",\n    to: \"/dashboard\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, \"Go Back\")), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    // movie_id={film}\n    onClick: e => onSubmit(e),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(StripeCheckoutButton, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }), \"}\")));\n};\n\nCheckoutPage.propTypes = {\n  updateFilm: PropTypes.func.isRequired,\n  getCurrentProfile: PropTypes.func.isRequired,\n  profile: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n  profile: state.profile\n});\n\nexport default connect(mapStateToProps, {\n  updateFilm,\n  getCurrentProfile\n})(withRouter(CheckoutPage)); // const CheckoutPage = ({\n// \tupdateFilm,\n// \tmatch,\n// \t//what's the diff these two profiles? \n// \tgetCurrentProfile,\n// \tprofile: { profile, loading },\n// \thistory, \n// \t// id,\n// }) => {\n// \tconst [formData, setFormData] = useState({\n// \t\t_id: '',\n// \t\tuser: '',\n// \t\ttitle: '',\n// \t\tdate: '',\n// \t\tcinema: '',\n// \t\timage: '',\n// \t\tticketPrice: '',\n// \t\tcrowdfundTarget: '',\n// \t\ttotalsoFar: ''\n// \t});\n// \tlet params = useParams();\n// \tconst [bookingTotal, setBookingTotal] = useState(0);\n// \tconst [currentFilm, useParams] = useState(params);\n// \t// fills the values with current values\n// \tuseEffect(() => {\n// \t\tgetCurrentProfile();\n// \tsetFormData({\n//       _id: !profile._id ? '' : profile._id,\n//       user: !profile.user ? '' : profile.user,\n//       title: !profile.title ? '' : profile.title,\n//       cinema: !profile.cinema ? '' : profile.cinema,\n//       date: !profile.date ? '' : profile.date,\n//       image: !profile.image ? '' : profile.image,\n//       ticketPrice: !profile.ticketPrice ? '' : profile.ticketPrice,\n//       crowdfundTarget: !profile.crowdfundTarget ? '' : profile.crowdfundTarget,\n//       totalsoFar: !profile.totalsoFar ? '' : profile.totalsoFar\n//     });\n//   }, [loading, getCurrentProfile]);\n// \t//console.log(profile)\n// \t// console.log(formData)\n// \tlet {\n// \t\t_id,\n// \t\tuser,\n// \t\ttitle,\n// \t\tdate,\n// \t\tcinema,\n// \t\timage,\n// \t\tticketPrice,\n// \t\tcrowdfundTarget,\n// \t\ttotalsoFar\n// \t} = formData;\n// \tlet tickets = 0;\n// \tconst onChange = e => {\n// \t\t// setFormData({ ...formData, [e.target.name]: e.target.value });\n// \t\ttickets = profile.totalsoFar + parseInt(e.target.value)\n// \t\tsetBookingTotal(parseInt(profile.ticketPrice) * parseInt(e.target.value));\n// \t\tsetFormData({ ...formData, totalsoFar: tickets });\n// \t\t// console.log(bookingTotal)\n// \t}\t\n// \tconst onSubmit = (e, film_id) => {\n// \t\te.preventDefault();\n// \t\tconsole.log(film_id)\n// \t\tupdateFilm(formData, history);\n// \t};\n// \treturn (\n// \t<div>\n// \t<form>\n// \t<div className='checkout-page how-it-works'>\n// \t\t<div className='checkout-header'>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Film: {profile.title}</span>\n// \t\t\t</div>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Date: {profile.date} </span>\n// \t\t\t</div>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Price: £{profile.ticketPrice} </span>\n// \t\t\t</div>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Crowdfunding Target: {profile.crowdfundTarget} </span>\n// \t\t\t</div>\n// \t\t\t<div \n// \t\t\tclassName='header-block'>\n// \t\t\t\t<span>Tickets sold: {profile.totalsoFar}</span>\n// \t\t\t</div>\n// \t\t\t<div \n// \t\t\tclassName='header-block'>\n// \t\t\t\t<span>{profile._id}</span>\n// \t\t\t</div>\n// \t\t</div>\n// \t\t</div>\n// \t\t</form>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<input\n// \t\t\t\t\ttype='number'\n// \t\t\t\t\tplaceholder='Enter number of tickets'\n// \t\t\t\t\tname='tickets'\n// \t\t\t\t\tonChange={e => onChange(e)}\n// \t\t\t\t/>\n// \t\t\t</div>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Basket total: £{bookingTotal}</span>\n// \t\t\t</div>\n// \t\t\t<div>\n// \t\t\t<Link className='btn btn-light my-1' to='/dashboard'>Go Back\n// \t\t\t</Link>\n// \t\t\t</div>\n// \t\t\t<div>\n// \t\t\t\t<span \n// \t\t\t\t// movie_id={film}\n// \t\t\t\tonClick={e => onSubmit(e)}>\n// \t\t\t\t\t<StripeCheckoutButton />\n// \t\t\t\t\t}\n// \t\t\t\t</span>\n// \t\t\t</div>\n// \t\t</div>\n// \t);\n// };","map":{"version":3,"sources":["/Users/andrewhigton/Documents/mern/SatCinemaClub/client/src/components/booking-page/BookingPage.js"],"names":["React","useEffect","useState","Fragment","useParams","Link","withRouter","Redirect","PropTypes","connect","updateFilm","getCurrentProfile","StripeCheckoutButton","queryString","CheckoutPage","history","_id","user","title","date","cinema","image","ticketPrice","crowdfundTarget","totalsoFar","setFormData","formData","params","film","bookingTotal","setBookingTotal","loading","tickets","onChange","e","profile","parseInt","target","value","onSubmit","film_id","preventDefault","console","log","propTypes","func","isRequired","object","mapStateToProps","state"],"mappings":"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Ae1B,OAAO,CAACuC,eAAD,EAAkB;AAAEtC,EAAAA,UAAF;AAAcC,EAAAA;AAAd,CAAlB,CAAP,CACdL,UAAU,CAACQ,YAAD,CADI,CAAf,C,CAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["// todo \n//at the moent - trying to get the screen to update with new model\n// 1 enter number of tickets, calculate price,  go to booking payment DONE\n// 2 send new object to createFilm - now can't update, creates new film. \n\t//if you update profile, you overwrite the current film\n\t//if you update with fn removed, you create new version of same film\n\t// what's the answer.\n\t// separate the creation and update functions DONE\n\t//need to separete the films and users, akin to exp in devconnectors, and update separately \n\t//but first, can you update via overwriting the _id first before major reconconstruction?\n// 3 create tickets, return to dashboard with tickets on dashboard\n// 4 with two sections, one for films, one for tickets \n// 5 why is bookpage called twice?\n// 6 why can i not navigate between the pages without losing the data?\n\n// morning\n// check video for ways out \n// try to get the _id working\n// at what point are you putting the films in to their own db? \n\n//ok, trying to get the id again, sure i can do it.\n//you know, just check back in to master.\n//can't load films now, something gone wrong with the db\n\nimport React, { useEffect, useState, Fragment } from 'react';\nimport { useParams} from 'react-router';\nimport { Link, withRouter, Redirect } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { updateFilm, getCurrentProfile } from '../../actions/profile';\nimport StripeCheckoutButton from '../../components/stripe-button/stripe-button';\nimport queryString from 'query-string';\n\nconst CheckoutPage = ({\n\tupdateFilm,\n\tgetCurrentProfile,\n\t// profile: { profile, loading },\n\thistory, \n\t// id,\n}) => {\n\tconst [formData, setFormData] = useState({\n\t\t_id: '',\n\t\tuser: '',\n\t\ttitle: '',\n\t\tdate: '',\n\t\tcinema: '',\n\t\timage: '',\n\t\tticketPrice: '',\n\t\tcrowdfundTarget: '',\n\t\ttotalsoFar: ''\n\t}, [setFormData]);\n\n\tlet params = useParams();\n\tconst film = params;\n\t\n\tconst [bookingTotal, setBookingTotal] = useState(0);\n\t\n\t// fills the values with current values\n\t\n\tuseEffect(() => {\n\t\tgetCurrentProfile();\n\tsetFormData({\n      _id: !film._id ? '' : film._id,\n      user: !film.user ? '' : film.user,\n      title: !film.title ? '' : film.title,\n      cinema: !film.cinema ? '' : film.cinema,\n      date: !film.date ? '' : film.date,\n      image: !film.image ? '' : film.image,\n      ticketPrice: !film.ticketPrice ? '' : film.ticketPrice,\n      crowdfundTarget: !film.crowdfundTarget ? '' : film.crowdfundTarget,\n      totalsoFar: !film.totalsoFar ? '' : film.totalsoFar\n    });\n  }, [loading, getCurrentProfile]);\n\n\tlet {\n\t\t_id,\n\t\tuser,\n\t\ttitle,\n\t\tdate,\n\t\tcinema,\n\t\timage,\n\t\tticketPrice,\n\t\tcrowdfundTarget,\n\t\ttotalsoFar\n\t} = formData;\n\n\tlet tickets = 0;\n\t\t\t\n\tconst onChange = e => {\n\t\t// setFormData({ ...formData, [e.target.name]: e.target.value });\n\t\ttickets = profile.totalsoFar + parseInt(e.target.value)\n\t\tsetBookingTotal(parseInt(profile.ticketPrice) * parseInt(e.target.value));\n\t\tsetFormData({ ...formData, totalsoFar: tickets });\n\t\t// console.log(bookingTotal)\n\t}\t\n\t\t\n\tconst onSubmit = (e, film_id) => {\n\t\te.preventDefault();\n\t\tconsole.log(film_id)\n\t\tupdateFilm(formData, history);\n\t};\n\n\treturn (\n\t<div>\n\t<form>\n\t<div className='checkout-page how-it-works'>\n\t\t<div className='checkout-header'>\n\t\t\t<div className='header-block'>\n\t\t\t\t<span>Film: {profile.title}</span>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div className='header-block'>\n\t\t\t\t<span>Date: {profile.date} </span>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div className='header-block'>\n\t\t\t\t<span>Price: £{profile.ticketPrice} </span>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div className='header-block'>\n\t\t\t\t<span>Crowdfunding Target: {profile.crowdfundTarget} </span>\n\t\t\t</div>\n\t\t\t<div \n\t\t\tclassName='header-block'>\n\t\t\t\t<span>Tickets sold: {profile.totalsoFar}</span>\n\t\t\t</div>\n\t\t\t<div \n\t\t\tclassName='header-block'>\n\t\t\t\t<span>{profile._id}</span>\n\t\t\t</div>\n\t\t</div>\n\t\t</div>\n\t\t</form>\n\t\t\t<div className='header-block'>\n\t\t\t\t<input\n\t\t\t\t\ttype='number'\n\t\t\t\t\tplaceholder='Enter number of tickets'\n\t\t\t\t\tname='tickets'\n\t\t\t\t\tonChange={e => onChange(e)}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div className='header-block'>\n\t\t\t\t<span>Basket total: £{bookingTotal}</span>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t<Link className='btn btn-light my-1' to='/dashboard'>Go Back\n\t\t\t</Link>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\n\t\t\t\t<span \n\t\t\t\t// movie_id={film}\n\t\t\t\tonClick={e => onSubmit(e)}>\n\t\t\t\t\t<StripeCheckoutButton />\n\t\t\t\t\t}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nCheckoutPage.propTypes = {\n\tupdateFilm: PropTypes.func.isRequired,\n\tgetCurrentProfile: PropTypes.func.isRequired,\n\tprofile: PropTypes.object.isRequired\n};\n\nconst mapStateToProps = state => ({\n\tprofile: state.profile\n});\n\nexport default connect(mapStateToProps, { updateFilm, getCurrentProfile })(\n\twithRouter(CheckoutPage)\n);\n\n// const CheckoutPage = ({\n// \tupdateFilm,\n// \tmatch,\n// \t//what's the diff these two profiles? \n// \tgetCurrentProfile,\n// \tprofile: { profile, loading },\n// \thistory, \n// \t// id,\n// }) => {\n// \tconst [formData, setFormData] = useState({\n// \t\t_id: '',\n// \t\tuser: '',\n// \t\ttitle: '',\n// \t\tdate: '',\n// \t\tcinema: '',\n// \t\timage: '',\n// \t\tticketPrice: '',\n// \t\tcrowdfundTarget: '',\n// \t\ttotalsoFar: ''\n// \t});\n\n// \tlet params = useParams();\n\t\n// \tconst [bookingTotal, setBookingTotal] = useState(0);\n// \tconst [currentFilm, useParams] = useState(params);\n\t\n// \t// fills the values with current values\n// \tuseEffect(() => {\n// \t\tgetCurrentProfile();\n// \tsetFormData({\n//       _id: !profile._id ? '' : profile._id,\n//       user: !profile.user ? '' : profile.user,\n//       title: !profile.title ? '' : profile.title,\n//       cinema: !profile.cinema ? '' : profile.cinema,\n//       date: !profile.date ? '' : profile.date,\n//       image: !profile.image ? '' : profile.image,\n//       ticketPrice: !profile.ticketPrice ? '' : profile.ticketPrice,\n//       crowdfundTarget: !profile.crowdfundTarget ? '' : profile.crowdfundTarget,\n//       totalsoFar: !profile.totalsoFar ? '' : profile.totalsoFar\n//     });\n\n//   }, [loading, getCurrentProfile]);\n// \t//console.log(profile)\n// \t// console.log(formData)\n// \tlet {\n// \t\t_id,\n// \t\tuser,\n// \t\ttitle,\n// \t\tdate,\n// \t\tcinema,\n// \t\timage,\n// \t\tticketPrice,\n// \t\tcrowdfundTarget,\n// \t\ttotalsoFar\n// \t} = formData;\n\n// \tlet tickets = 0;\n\t\t\t\n// \tconst onChange = e => {\n// \t\t// setFormData({ ...formData, [e.target.name]: e.target.value });\n// \t\ttickets = profile.totalsoFar + parseInt(e.target.value)\n// \t\tsetBookingTotal(parseInt(profile.ticketPrice) * parseInt(e.target.value));\n// \t\tsetFormData({ ...formData, totalsoFar: tickets });\n// \t\t// console.log(bookingTotal)\n// \t}\t\n\t\t\n// \tconst onSubmit = (e, film_id) => {\n// \t\te.preventDefault();\n// \t\tconsole.log(film_id)\n// \t\tupdateFilm(formData, history);\n// \t};\n\n// \treturn (\n// \t<div>\n// \t<form>\n// \t<div className='checkout-page how-it-works'>\n// \t\t<div className='checkout-header'>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Film: {profile.title}</span>\n// \t\t\t</div>\n\t\t\t\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Date: {profile.date} </span>\n// \t\t\t</div>\n\t\t\t\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Price: £{profile.ticketPrice} </span>\n// \t\t\t</div>\n\t\t\t\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Crowdfunding Target: {profile.crowdfundTarget} </span>\n// \t\t\t</div>\n// \t\t\t<div \n// \t\t\tclassName='header-block'>\n// \t\t\t\t<span>Tickets sold: {profile.totalsoFar}</span>\n// \t\t\t</div>\n// \t\t\t<div \n// \t\t\tclassName='header-block'>\n// \t\t\t\t<span>{profile._id}</span>\n// \t\t\t</div>\n// \t\t</div>\n// \t\t</div>\n// \t\t</form>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<input\n// \t\t\t\t\ttype='number'\n// \t\t\t\t\tplaceholder='Enter number of tickets'\n// \t\t\t\t\tname='tickets'\n// \t\t\t\t\tonChange={e => onChange(e)}\n// \t\t\t\t/>\n// \t\t\t</div>\n// \t\t\t<div className='header-block'>\n// \t\t\t\t<span>Basket total: £{bookingTotal}</span>\n// \t\t\t</div>\n// \t\t\t<div>\n// \t\t\t<Link className='btn btn-light my-1' to='/dashboard'>Go Back\n// \t\t\t</Link>\n// \t\t\t</div>\n// \t\t\t<div>\n\t\t\n// \t\t\t\t<span \n// \t\t\t\t// movie_id={film}\n// \t\t\t\tonClick={e => onSubmit(e)}>\n// \t\t\t\t\t<StripeCheckoutButton />\n// \t\t\t\t\t}\n// \t\t\t\t</span>\n// \t\t\t</div>\n// \t\t</div>\n// \t);\n// };\n"]},"metadata":{},"sourceType":"module"}